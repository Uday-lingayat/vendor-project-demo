<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>StreetSupply | Vendor Platform</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   <style>
    :root {
      --primary: #FF693A;
      --secondary: #209F96;
      --light: #FFF5EB;
      --dark: #333333;
      --gray: #f5f5f5;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background-color: #f5f7fa;
      color: var(--dark);
      min-height: 100vh;
    }

    /* Header */
    header {
      background-color: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      padding: 1rem 2rem;
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--dark);
      cursor: pointer;
    }

    .logo span {
      color: var(--primary);
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 25px;
    }

    .search-bar {
      display: flex;
      align-items: center;
      background: var(--gray);
      padding: 0.8rem 1.2rem;
      border-radius: 50px;
      width: 400px;
    }

    .search-bar input {
      border: none;
      background: transparent;
      padding: 0.5rem;
      width: 100%;
      outline: none;
      font-size: 1rem;
    }

    .cart-icon {
      position: relative;
      font-size: 1.4rem;
      color: var(--dark);
      cursor: pointer;
    }

    .cart-count {
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--primary);
      color: white;
      font-size: 0.7rem;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
    }

    .user-profile img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--primary);
    }

    /* Navigation */
    .nav-tabs {
      display: flex;
      background: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      padding: 0 2rem;
    }

    .nav-tab {
      padding: 1rem 1.5rem;
      cursor: pointer;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      transition: all 0.3s ease;
    }

    .nav-tab.active {
      color: var(--primary);
      border-bottom-color: var(--primary);
    }

    .nav-tab:hover:not(.active) {
      color: var(--primary);
      border-bottom-color: rgba(255, 105, 58, 0.3);
    }

    /* Main Content */
    .main-content {
      padding: 20px;
      display: none;
    }

    .main-content.active {
      display: block;
    }

    /* Overlay Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      z-index: 999;
      display: none;
    }

    .modal-overlay.active {
      display: block;
    }

    .cart-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.3);
      z-index: 999;
      display: none;
    }

    .cart-overlay.active {
      display: block;
    }

    /* Dashboard Styles */
    .dashboard-title {
      font-size: 1.8rem;
      margin-bottom: 20px;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .dashboard-title i {
      color: var(--primary);
    }

    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .card {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s ease;
      border-top: 4px solid var(--primary);
    }

    .card:hover {
      transform: translateY(-5px);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .card-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--dark);
    }

    .card-icon {
      width: 50px;
      height: 50px;
      border-radius: 10px;
      background: rgba(255, 107, 53, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: var(--primary);
    }

    .card-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--dark);
      margin-bottom: 5px;
    }

    .card-footer {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 0.9rem;
      color: #28a745;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .btn {
      padding: 8px 15px;
      border-radius: 6px;
      font-weight: 500;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .btn-outline {
      background: transparent;
      border: 1px solid #ddd;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: #e55a2a;
    }

    .chart {
      height: 300px;
      position: relative;
    }

    .current-orders,
    .recent-orders {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      margin-bottom: 30px;
      overflow-x: auto;
    }

    .table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    .table th {
      text-align: left;
      padding: 12px 15px;
      background: #f8f9fa;
      font-weight: 600;
      color: var(--dark);
    }

    .table td {
      padding: 12px 15px;
      border-bottom: 1px solid #eee;
    }

    .status {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }

    .status.pending {
      background: rgba(255, 193, 7, 0.2);
      color: #d39e00;
    }

    .status.completed {
      background: rgba(40, 167, 69, 0.2);
      color: #28a745;
    }

    .status.processing {
      background: rgba(0, 123, 255, 0.2);
      color: #0069d9;
    }

    .action-btn {
      padding: 5px 10px;
      border-radius: 4px;
      background: #f1f3f9;
      color: var(--dark);
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .action-btn:hover {
      background: var(--primary);
      color: white;
    }

    .timeline {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 20px 0;
      position: relative;
      height: 6px;
      background-color: #e0e0e0;
      border-radius: 3px;
      padding: 0 10px;
    }

    .timeline::before {
      content: '';
      position: absolute;
      height: 6px;
      left: 0;
      top: 0;
      background-color: var(--primary);
      z-index: 1;
      border-radius: 3px;
      transition: width 0.3s ease;
    }

    .step {
      position: relative;
      z-index: 2;
      width: 20px;
      height: 20px;
      background-color: #ccc;
      border-radius: 50%;
      border: 3px solid white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      color: white;
      font-weight: bold;
    }

    .step.completed {
      background-color: var(--primary);
    }

    .step-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      font-size: 0.8rem;
      color: var(--dark);
    }

    /* Profile Styles */
    .profile-title {
      font-size: 1.75rem;
      color: var(--dark);
      margin-bottom: 1rem;
    }

    .profile-card {
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .profile-section-title {
      font-size: 1.25rem;
      color: var(--secondary);
      margin-bottom: 1.25rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid var(--light);
    }

    .profile-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.25rem;
    }

    .info-group {
      margin-bottom: 1rem;
    }

    .info-label {
      font-weight: 600;
      color: var(--dark);
      margin-bottom: 0.5rem;
      display: block;
      font-size: 0.9rem;
    }

    .info-value {
      padding: 0.75rem 1rem;
      background-color: var(--light);
      border-radius: 5px;
      border: 1px solid rgba(51, 51, 51, 0.1);
      font-size: 0.95rem;
    }

    .info-edit {
      display: none;
      padding: 0.75rem 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 100%;
      font-size: 0.95rem;
    }

    .map-container {
      height: 200px;
      background-color: #eee;
      border-radius: 5px;
      margin-top: 1.25rem;
      overflow: hidden;
    }

    /* Shop Styles */
    .page-title {
      font-size: 1.8rem;
      margin-bottom: 1.5rem;
      color: var(--dark);
    }

    .category-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 1.5rem;
    }

    .category-btn {
      padding: 0.5rem 1rem;
      border-radius: 20px;
      border: 1px solid #ddd;
      background: white;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .category-btn.active,
    .category-btn:hover {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
    }

    .product-card {
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s ease;
      cursor: pointer;
      position: relative;
    }

    .product-card:hover {
      transform: translateY(-5px);
    }

    .product-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: var(--primary);
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .product-img {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }

    .product-info {
      padding: 1rem;
    }

    .product-category {
      font-size: 0.8rem;
      color: var(--secondary);
      margin-bottom: 0.5rem;
    }

    .product-name {
      font-size: 1rem;
      margin-bottom: 0.5rem;
      color: var(--dark);
    }

    .product-supplier {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }

    .supplier-logo {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      object-fit: cover;
    }

    .product-rating {
      display: flex;
      align-items: center;
      gap: 5px;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }

    .product-price {
      font-weight: 700;
      color: var(--dark);
      font-size: 1.1rem;
    }

    /* Product Modal */
    .product-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      background: white;
      border-radius: 10px;
      z-index: 1000;
      display: none;
    }

    .product-modal.active {
      display: block;
    }

    .modal-content {
      position: relative;
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--dark);
      z-index: 1;
    }

    .modal-img {
      max-width: 100%;
      max-height: 300px;
      object-fit: contain;
      margin: 0 auto;
      display: block;
    }

    .modal-img-container {
      display: flex;
      justify-content: center;
      align-items: center;
      background: #f5f5f5;
      padding: 20px;
    }

    .modal-details {
      padding: 1.5rem;
    }

    .modal-details h2 {
      margin-bottom: 1rem;
      color: var(--dark);
    }

    .modal-details p {
      margin-bottom: 0.75rem;
    }

    .product-price {
      font-size: 1.5rem;
      margin: 1rem 0;
      color: var(--primary);
    }

    .modal-cart-controls {
      display: flex;
      gap: 15px;
      margin-top: 1.5rem;
    }

    .qty-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .qty-btn {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      border: 1px solid #ddd;
      background: white;
      cursor: pointer;
      font-size: 1rem;
    }

    .btn-cart-modal {
      padding: 0.75rem 1.5rem;
      border-radius: 5px;
      background: var(--primary);
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      flex-grow: 1;
    }

    /* Cart Drawer */
    .cart-drawer {
      position: fixed;
      top: 0;
      right: -400px;
      width: 400px;
      height: 100%;
      background: white;
      box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
      transition: right 0.3s ease;
      z-index: 1000;
      display: flex;
      flex-direction: column;
    }

    .cart-drawer.open {
      right: 0;
    }

    .cart-header {
      padding: 1.5rem;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cart-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
    }

    .cart-items {
      padding: 1.5rem;
      flex-grow: 1;
      overflow-y: auto;
    }

    .cart-item {
      padding: 1rem 0;
      border-bottom: 1px solid #eee;
    }

    .btn-proceed {
      padding: 1rem;
      background: var(--primary);
      color: white;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 1.5rem;
      border-radius: 5px;
    }

    .btn-proceed:hover {
      background: #e55a2a;
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .grid-2 {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      header {
        padding: 1rem;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .logo {
        font-size: 1.5rem;
      }

      .header-controls {
        order: 3;
        width: 100%;
        justify-content: space-between;
      }

      .search-bar {
        width: 100%;
      }

      .nav-tabs {
        overflow-x: auto;
        white-space: nowrap;
        padding: 0 1rem;
      }

      .nav-tab {
        padding: 1rem;
      }

      .cart-drawer {
        width: 100%;
        right: -100%;
      }

      .product-modal {
        width: 95%;
      }

      .modal-img {
        height: 200px;
      }
    }

    @media (max-width: 576px) {

      .cards,
      .products-grid {
        grid-template-columns: 1fr;
      }

      .search-bar {
        display: none;
      }

      .user-profile .user-name {
        display: none;
      }

      .modal-cart-controls {
        flex-direction: column;
      }
    }
  </style> <!-- Your CSS -->
</head>
<body>
  <header>
    <div class="logo" id="homeBtn">
      <i class="fas fa-store"></i>
      <div>Street<span>Supply</span></div>
    </div>
    <div class="header-controls">
      <div class="search-bar" id="searchBar">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="Search..." id="searchInput">
      </div>
      <div class="cart-icon" id="cartIcon">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-count" id="cartCount">0</span>
      </div>
      <div class="user-profile" id="profileBtn">
        <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="User">
        <div class="user-name" id="userName"></div>
      </div>
    </div>
  </header>

  <div class="nav-tabs">
    <div class="nav-tab active" data-tab="dashboard">Dashboard</div>
    <div class="nav-tab" data-tab="shop">Shop Supplies</div>
    <div class="nav-tab" data-tab="profile">My Profile</div>
  </div>

  <main>
    <!-- Dashboard Section -->
    <div class="main-content active" id="dashboard">
      <h1 class="dashboard-title">
        <i class="fas fa-tachometer-alt"></i> Vendor Dashboard
      </h1>
      <div class="cards">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Current Orders</div>
            <div class="card-icon"><i class="fas fa-shopping-bag"></i></div>
          </div>
          <div class="card-value" id="currentOrdersCount">0</div>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">Shop Now</div>
            <div class="card-icon"><i class="fas fa-store"></i></div>
          </div>
          <div class="card-value">Visit Raw Material Store</div>
          <div class="card-footer">
            <button class="btn btn-primary" id="shopNowBtn">Shop Now</button>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">Your Profile</div>
            <div class="card-icon"><i class="fas fa-user"></i></div>
          </div>
          <div class="card-value" id="profileName">Welcome!</div>
          <div class="card-footer">
            <button class="btn btn-primary" id="profileBtn2">Go to Profile</button>
          </div>
        </div>
      </div>

      <!-- Current Orders -->
      <div class="current-orders">
        <h2>Current Orders</h2>
        <table class="table">
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Customer</th>
              <th>Item Name</th>
              <th>Order Progress</th>
            </tr>
          </thead>
          <tbody id="currentOrdersBody"></tbody>
        </table>
      </div>

      <!-- Recent Orders -->
      <div class="recent-orders">
        <h2>Recent Orders</h2>
        <table class="table">
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Customer</th>
              <th>Item Name</th>
              <th>Date</th>
              <th>Amount</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="recentOrdersBody"></tbody>
        </table>
        <button id="viewMoreBtn" class="btn btn-secondary" style="margin-top:10px;">View More</button>
      </div>
    </div>

    <!-- Shop Section -->
    <div class="main-content" id="shop">
      <h1 class="page-title">Shop Supplies</h1>
      <div class="category-filters">
        <button class="category-btn active">All Products</button>
        <button class="category-btn">Veg</button>
        <button class="category-btn">Nonveg</button>
        <button class="category-btn">Dairy</button>
        <button class="category-btn">Grain</button>
        <button class="category-btn">Spice</button>
        <button class="category-btn">Oils</button>
        <button class="category-btn">Bakery</button>
      </div>
      <div class="products-grid" id="products-container"></div>
    </div>

    <!-- Profile Section -->
    <div class="main-content" id="profile">
      <div class="profile-header">
        <h1 class="profile-title">My Profile</h1>
      </div>
      <div class="profile-card">
        <h2 class="profile-section-title">Personal Information</h2>
        <div class="profile-info">
          <div class="info-group">
            <span class="info-label">Full Name</span>
            <div class="info-value" id="fullNameView"></div>
          </div>
          <div class="info-group">
            <span class="info-label">Email Address</span>
            <div class="info-value" id="emailView"></div>
          </div>
          <div class="info-group">
            <span class="info-label">Phone Number</span>
            <div class="info-value" id="phoneView"></div>
          </div>
        </div>

        <h2 class="profile-section-title">Vendor Information</h2>
        <div class="profile-info">
          <div class="info-group">
            <span class="info-label">Vendor Name</span>
            <div class="info-value" id="restaurantNameView"></div>
          </div>
          <div class="info-group">
            <span class="info-label">Vendor Type</span>
            <div class="info-value" id="restaurantTypeView"></div>
          </div>
          <div class="info-group">
            <span class="info-label">Location</span>
            <div class="info-value" id="locationView"></div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Cart Drawer -->
  <div class="cart-drawer" id="cartDrawer">
    <div class="cart-header">
      <h3>Your Cart</h3>
      <button class="cart-close" id="closeCart">&times;</button>
    </div>
    <div class="cart-items" id="cartItems"></div>
    <button class="btn-proceed" id="checkoutBtn">Proceed to Checkout</button>
  </div>


<script>
document.addEventListener('DOMContentLoaded', () => {
    function getCSRFToken() {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let cookie of cookies) {
                cookie = cookie.trim();
                if (cookie.startsWith('csrftoken=')) {
                    cookieValue = cookie.substring('csrftoken='.length);
                    break;
                }
            }
        }
        return cookieValue;
    }

    let allProducts = [],
        cart = JSON.parse(localStorage.getItem('cart')) || [],  // Persisted cart
        ordersData = { currentOrders: [], recentOrders: [] },
        profileData = {};
    const tabElements = document.querySelectorAll('.nav-tab');
    const contentElements = document.querySelectorAll('.main-content');
    const cartIcon = document.getElementById('cartIcon');
    const cartDrawer = document.getElementById('cartDrawer');
    const closeCart = document.getElementById('closeCart');
    const cartItemsEl = document.getElementById('cartItems');
    const cartCountEl = document.getElementById('cartCount');
    const productsContainer = document.getElementById('products-container');
    const searchInput = document.getElementById('searchInput');
    const checkoutBtn = document.getElementById('checkoutBtn');

    // ====== Utility ======
    function saveCart() {
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount();
    }

    function updateCartCount() {
        cartCountEl.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
    }

    function switchTab(tabId) {
        tabElements.forEach(tab => tab.classList.toggle('active', tab.dataset.tab === tabId));
        contentElements.forEach(content => content.classList.toggle('active', content.id === tabId));
    }

    function toggleCartDrawer() {
        cartDrawer.classList.toggle('open');
        renderCartItems();
    }

    // ====== Orders Rendering ======
   function renderOrders(data) {
    // Current Orders
    document.getElementById("currentOrdersCount").textContent = data.currentOrders.length;
    const currentOrdersBody = document.getElementById("currentOrdersBody");
    currentOrdersBody.innerHTML = "";
    data.currentOrders.forEach(order => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${order.order_id}</td>
            <td>${order.customer}</td>
            <td>${order.item_name}</td>
            <td>
                <div class="timeline">
                    ${generateSteps(order.progress)}
                </div>
                <div class="step-labels">
                    <span>Accepted</span>
                    <span>Packed</span>
                    <span>Dispatched</span>
                </div>
            </td>`;
        currentOrdersBody.appendChild(row);
    });

    // Recent Orders (only 3 initially)
    const recentOrdersBody = document.getElementById("recentOrdersBody");
    recentOrdersBody.innerHTML = "";
    let visibleOrders = data.recentOrders.slice(0, 3);  // Show only 3
    visibleOrders.forEach(order => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${order.order_id}</td>
            <td>${order.customer}</td>
            <td>${order.item_name}</td>
            <td>${order.date}</td>
            <td>₹${order.amount}</td>`;
        recentOrdersBody.appendChild(row);
    });

    // Handle "View More"
    const viewMoreBtn = document.getElementById("viewMoreBtn");
    viewMoreBtn.onclick = () => {
        recentOrdersBody.innerHTML = "";
        data.recentOrders.forEach(order => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${order.order_id}</td>
                <td>${order.customer}</td>
                <td>${order.item_name}</td>
                <td>${order.date}</td>
                <td>₹${order.amount}</td>`;
            recentOrdersBody.appendChild(row);
        });
        viewMoreBtn.style.display = 'none'; // Hide button after expanding
    };
}

    function generateSteps(progress) {
        const steps = ["✓", "✓", "✓"];
        return steps.map((val, idx) =>
            `<div class="step ${idx < progress ? "completed" : ""}">${val}</div>`
        ).join("");
    }

    // ====== Cart Rendering ======
    function renderCartItems() {
        cartItemsEl.innerHTML = cart.length === 0 ? '<p>Your cart is empty.</p>' : '';
        cart.forEach((item, index) => {
            const div = document.createElement('div');
            div.classList.add('cart-item');
            div.innerHTML = `
                <h4>${item.name}</h4>
                <p>Qty: ${item.quantity} | ₹${item.price * item.quantity}</p>
                <button class="remove-btn" data-index="${index}">Remove</button>
            `;
            div.querySelector('.remove-btn').addEventListener('click', () => {
                cart.splice(index, 1);
                saveCart();
                renderCartItems();
            });
            cartItemsEl.appendChild(div);
        });
        updateCartCount();
    }

    // ====== Products Rendering ======
    function renderProducts(products) {
        productsContainer.innerHTML = '';
        products.forEach(product => {
            const card = document.createElement('div');
            card.classList.add('product-card');
            card.innerHTML = `
                <img src="${product.image}" alt="${product.name}">
                <h3>${product.name}</h3>
                <p>₹${product.price}</p>`;
            const btn = document.createElement('button');
            btn.textContent = 'Add to Cart';
            btn.addEventListener('click', () => {
                const existing = cart.find(p => p.id === product.id);
                if (existing) existing.quantity++;
                else cart.push({ ...product, quantity: 1 });
                saveCart();
                renderCartItems();
                alert(`${product.name} added to cart`);
            });
            card.appendChild(btn);
            productsContainer.appendChild(card);
        });
    }

    // ====== Profile ======
    function populateProfile(data) {
        document.getElementById('fullNameView').textContent = `${data.first_name} ${data.last_name}`;
        document.getElementById('emailView').textContent = data.email;
        document.getElementById('phoneView').textContent = data.profile_data?.phone || 'N/A';
        document.getElementById('restaurantNameView').textContent = data.profile_data?.company_name || data.profile_data?.organization_name || 'N/A';
        document.getElementById('restaurantTypeView').textContent = data.profile_data?.business_type || data.profile_data?.business_category || 'N/A';
        document.getElementById('locationView').textContent = data.profile_data?.address || 'N/A';
    }

    // ====== Checkout ======
   checkoutBtn.addEventListener('click', () => {
    if (cart.length === 0) {
        alert("Your cart is empty!");
        return;
    }

    fetch('/api/orders/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCSRFToken()
        },
        body: JSON.stringify({ items: cart })
    })
    .then(res => res.json())
    .then(data => {
    alert("Order placed successfully!");
    cart = [];  // Clear the cart
    updateCartCount();
    renderCartItems();  // Refresh the cart UI
    toggleCartDrawer();  // Close the drawer

    // Refresh orders
    fetch('/api/orders/')
        .then(res => res.json())
        .then(updatedOrders => {
            ordersData = updatedOrders;
            renderOrders(ordersData);
        });
})

    .catch(err => {
        console.error(err);
        alert("Error placing order. Please try again.");
    });
});


    // ====== Event Bindings ======
    tabElements.forEach(tab => tab.addEventListener('click', () => switchTab(tab.dataset.tab)));
    cartIcon.addEventListener('click', toggleCartDrawer);
    closeCart.addEventListener('click', toggleCartDrawer);
    searchInput.addEventListener('input', () => {
        const q = searchInput.value.toLowerCase();
        renderProducts(allProducts.filter(p => p.name.toLowerCase().includes(q)));
    });

    // ====== Initial Load ======
    Promise.all([
        fetch('/api/products/').then(r => r.json()),
        fetch('/api/orders/').then(r => r.json()),
        fetch('/api/profile/').then(r => r.json())
    ])
        .then(([products, orders, profile]) => {
            allProducts = products;
            ordersData = orders;
            profileData = profile;
            renderProducts(allProducts);
            renderOrders(ordersData);
            populateProfile(profileData);
            renderCartItems();
            updateCartCount();
        })
        .catch(err => console.error(err));
});

// Switch tab function
// function switchTab(tabId) {
//     document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.toggle('active', tab.dataset.tab === tabId));
//     document.querySelectorAll('.main-content').forEach(content => content.classList.toggle('active', content.id === tabId));
// }
//
// // Button actions
// document.getElementById('shopNowBtn').addEventListener('click', () => switchTab('shop'));
// document.getElementById('profileBtn2').addEventListener('click', () => switchTab('profile'));

// Switch tab function
function switchTab(tabId) {
    document.querySelectorAll('.nav-tab').forEach(tab =>
        tab.classList.toggle('active', tab.dataset.tab === tabId)
    );
    document.querySelectorAll('.main-content').forEach(content =>
        content.classList.toggle('active', content.id === tabId)
    );
}

// Button actions
document.getElementById('shopNowBtn').addEventListener('click', () => switchTab('shop'));
document.getElementById('profileBtn2').addEventListener('click', () => switchTab('profile'));
document.getElementById('profileBtn').addEventListener('click', () => switchTab('profile')); // Top-right logo/profile


</script>

</body>
</html>